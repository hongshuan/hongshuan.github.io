<!DOCTYPE html>
<html>
<head>
<meta charSet="utf-8"/>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<title>Make Powerpoint</title>
<style>
* { box-sizing: border-box }
body {
    width: 80%;
    margin: 0 auto;
    font-family: "Lato", sans-serif;
}
textarea {
    padding: 10px 0;
    border: none;
    text-align: center;
    font-size: 24px;
    width: 100%;
    height: 495px;
    resize: none;
}

.btn {
    background-color: #1c97f3;
    border: none;
    color: white;
    padding: 8px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
	border:1px solid #186dad;
}
.right { position: relative; left: 50%; }

/* Style the tab */
.tab {
    float: left;
    border: 1px solid #ccc;
    background-color: #f1f1f1;
    width: 20%;
    height: 500px;
}

/* Style the buttons inside the tab */
.tab button {
    display: block;
    background-color: inherit;
    color: black;
    padding: 22px 16px;
    width: 100%;
    border: none;
    outline: none;
    text-align: left;
    cursor: pointer;
    transition: 0.3s;
    font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
    background-color: #ddd;
}

/* Create an active/current "tab button" class */
.tab button.active {
    background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
    float: left;
    padding: 0px 10px;
    border: 1px solid #ccc;
    width: 70%;
    border-left: none;
    height: 500px;
}
</style>
</head>
<body>
<h1>Fast Make PowerPoint</h1>
<div class="container">

    <div class="tab">
      <button class="tablinks" onclick="openTab(event, 'song1')" id="defaultOpen">Song - 1</button>
      <button class="tablinks" onclick="openTab(event, 'song2')">Song - 2</button>
      <button class="tablinks" onclick="openTab(event, 'song3')">Song - 3</button>
      <button class="tablinks" onclick="openTab(event, 'song4')">Song - 4</button>
      <button class="tablinks" onclick="openTab(event, 'song5')">Song - 5</button>
      <button class="tablinks" onclick="openTab(event, 'song6')">Song - 6</button>
    </div>

    <div id="song1" class="tabcontent"><textarea></textarea></div>
    <div id="song2" class="tabcontent"><textarea></textarea></div>
    <div id="song3" class="tabcontent"><textarea></textarea></div>
    <div id="song4" class="tabcontent"><textarea></textarea></div>
    <div id="song5" class="tabcontent"><textarea></textarea></div>
    <div id="song6" class="tabcontent"><textarea></textarea></div>

    <div style="float: clear; margin-top: 10px;"></div>

    <button class="btn right" id="download">Download &nbsp;&#x2714;</button>
</div>

<!-- script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script -->
<!-- script src="https://cdn.rawgit.com/gitbrent/PptxGenJS/v2.0.0/dist/pptxgen.bundle.js"></script -->
<script src="https://cdn.rawgit.com/gitbrent/PptxGenJS/v2.2.0/dist/pptxgen.bundle.js"></script>

<script>
function formatDate(date) {
  var monthNames = [ "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec" ];
  var day = date.getDate();
  var monthIndex = date.getMonth();
  var year = date.getFullYear();

  return monthNames[monthIndex] + '-' + day + '-' + year;
}
//console.log(formatDate(new Date()));

function shuffle(a) {
    var j, x, i;
    for (i = a.length - 1; i > 0; i--) {
        j = Math.floor(Math.random() * (i + 1));
        x = a[i];
        a[i] = a[j];
        a[j] = x;
    }
    return a;
}

function openTab(evt, tabId) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabId).style.display = "block";
    evt.currentTarget.className += " active";
}

function createThemes(pptx) {
    for (var i=0; i<10; i++) {
        pptx.defineSlideMaster({
            title: 'THEME_' + i,
            bkgd: { path: 'http://hongshuan.github.io/images/' + i + '.jpg' },
        });
    }

    var bkcolors = shuffle([ '0088CC', '36ABFF', '99ABCC', '7AB800', '666666',
        'A9A9A9', '003366', '0099CC', '336699', '666699', '669999', '339999' ]);
    return bkcolors;
}

function createSong(pptx, song, theme) {

    var pages = song.split('\n\n');

    for (var p=0; p<pages.length; p++) {
        var slide = pptx.addNewSlide();
        var text = pages[p];
        var lines = text.split('\n');
        var textcolor = 'FFFFFF';

        slide.back = theme;
      //slide.color = 'FFFFFF';

        if (p == 0 && lines.length > 1) {
            slide.addText(
                [
                    { text: lines[0], options: { align: 'c', fontSize: 48, bold: true, color:textcolor } },
                    { text: lines[1], options: { align: 'c', fontSize: 24, bold: true, color:textcolor } }
                ],
                { x: 0, y: 0, w: '100%', h: '80%' }
            );
        } else {
            slide.addText(text, {
              //shape:     pptx.shapes.RECTANGLE,
                align:     'c',
                x:         0,
                y:         0,
                w:         '100%',
                h:         '80%',
              //fill:      '0088CC',
                fontSize:  48,
                bold:      true,
                breakLine: true,
                color:     textcolor
            });
        }
    }
}
</script>

<script>
$(document).ready(function() {
    $("#download").click(function(e) {
        var pptx = new PptxGenJS();

        var themes = createThemes(pptx);

        for (var i=0; i<6; i++) {
            var song = $('#song' + (i+1) + ' textarea').val();
            if (song.length > 10) {
                createSong(pptx, song, themes[i]);
            }
        }

        pptx.save(formatDate(new Date()));
    })

    // Get the element with id="defaultOpen" and click on it
    document.getElementById("defaultOpen").click();
});
</script>
</body>
</html>
